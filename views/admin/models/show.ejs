<% pageTitle = 'Asset Model' %>
<%
  const safeModel = (typeof model !== 'undefined' && model) ? model : {};
  const manufacturerName = safeModel.manufacturer ? safeModel.manufacturer.name : '-';
  const categoryName = safeModel.category ? safeModel.category.name : '-';
  const attachments = Array.isArray(safeModel.attachments) ? safeModel.attachments : [];
%>

<section class="admin models">
  <div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3 mb-4">
    <div>
      <h1 class="h3 mb-1"><%= safeModel.name || 'Asset Model' %></h1>
      <p class="text-muted mb-0">Hersteller: <%= manufacturerName %></p>
    </div>
    <div class="d-flex gap-2">
      <a href="/admin/asset-models" class="btn btn-outline-secondary">Zur Übersicht</a>
      <a href="/admin/asset-models/<%= safeModel.id %>/edit" class="btn btn-primary">Bearbeiten</a>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">
      <dl class="row mb-0">
        <dt class="col-sm-3">Name</dt>
        <dd class="col-sm-9"><%= safeModel.name || '-' %></dd>
        <dt class="col-sm-3">Hersteller</dt>
        <dd class="col-sm-9"><%= manufacturerName %></dd>
        <dt class="col-sm-3">Kategorie</dt>
        <dd class="col-sm-9"><%= categoryName %></dd>
        <dt class="col-sm-3">Status</dt>
        <dd class="col-sm-9">
          <% if (safeModel.isActive) { %>
            <span class="badge text-bg-success">Aktiv</span>
          <% } else { %>
            <span class="badge text-bg-danger">Inaktiv</span>
          <% } %>
        </dd>
        <dt class="col-sm-3">Beschreibung</dt>
        <dd class="col-sm-9"><%= safeModel.description || '-' %></dd>
        <dt class="col-sm-3">Technische Beschreibung</dt>
        <dd class="col-sm-9"><%= safeModel.technicalDescription || '-' %></dd>
        <dt class="col-sm-3">Bild-URL</dt>
        <dd class="col-sm-9">
          <% if (safeModel.imageUrl) { %>
            <a href="<%= safeModel.imageUrl %>" target="_blank" rel="noreferrer">Bild öffnen</a>
          <% } else { %>
            -
          <% } %>
        </dd>
        <dt class="col-sm-3">Bilder</dt>
        <dd class="col-sm-9">
          <% if (attachments.length) { %>
            <div class="d-flex flex-wrap gap-2">
              <% attachments.forEach(function(img) { %>
                <a href="<%= img.url %>" target="_blank" rel="noreferrer" class="d-inline-block w-25">
                  <div class="ratio ratio-4x3">
                    <img src="<%= img.url %>" alt="Asset Model Bild" class="img-thumbnail object-fit-cover w-100 h-100">
                  </div>
                </a>
              <% }) %>
            </div>
          <% } else { %>
            -\n
          <% } %>
        </dd>
      </dl>
    </div>
    <div class="card-footer d-flex justify-content-end">
      <form method="post" action="/admin/asset-models/<%= safeModel.id %>/delete">
        <input type="hidden" name="csrfToken" value="<%= csrfToken || '' %>">
        <button type="submit" class="btn btn-outline-danger">Löschen</button>
      </form>
    </div>
  </div>
</section>
